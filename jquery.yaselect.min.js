/*
* yaselect
* is yet-another jquery plugin for making <select> elements stylable by CSS
* http://github.com/choonkeat/yaselect
*
* Copyright (c) 2011 Chew Choon Keat
* Released under the MIT license
*
* Modified by Supernormal
*/
(function(a){a.fn.yaselect=function(b){function d(a){var b="",c=0;return a[0].selectedIndex&&(c=a[0].selectedIndex),b=a.find("option:nth("+c+")").text()}function e(a,b){var c=d(a);""===c&&(c=a.children("option:selected").text()),c+='<div class="yaselect-right-image"></div>',b.html(c)}function f(a,b,c,d){a.blur(),e(a,b),d&&c.focus()}function g(a){a.toggleClass("yaselect-open yaselect-close")}function h(){return"ontouchstart"in document}var c={individualStyling:!0,size:5,reuseWidth:!0};return b=a.extend(c,b),this.each(function(c){var i,j,k,m,n,o,d=a(this),l=0;if(d.hasClass("yaselect-select"))return!0;if(i=a('<div class="yaselect-wrap yaselect-open"><div class="yaselect-current"></div></div>'),j=i.wrap('<div class="yaselect-anchor"></div>').parent(),k=i.find(".yaselect-current"),m=d.find("option"),n=d[0].selectedIndex,d.addClass("yaselect-select"),e(d,k),b.individualStyling&&i.addClass("yaselect-wrap-"+c),h()?(g(i),d.before(j).css({opacity:.001,left:0,top:0,zIndex:10}).on("change",function(){e(d,k)}).appendTo(j)):d.before(j).on("keydown",function(a){(13===a.keyCode||32===a.keyCode)&&(a.preventDefault(),f(d,k,i,!0))}).on("change",function(){e(d,k)}).on("blur",function(){d.css("z-index",0).hide(),g(i)}).on("click",function(){d.is(":hidden")?(g(i),d.css("z-index",1).show(),setTimeout(function(){d.focus()})):f(d,k,i,!0)}).appendTo(j),i.on("mousedown",function(){d.click()}).on("keydown",function(b){var c=[13,32,37,38,39,40];-1!==a.inArray(b.keyCode,c)&&(b.preventDefault(),d.click())}),b.reuseWidth&&(m.each(function(){var b=0;m.removeAttr("selected"),a(this).attr("selected","selected"),e(d,k),b=j.outerWidth(),b>l&&(l=b)}),m.removeAttr("selected").eq(n).attr("selected","selected"),l+=i.find(".yaselect-right-image").outerWidth(),j.width(l)),h()){for(d.css("width",j.width());d.outerHeight()<j.outerHeight();)o=parseInt(d.css("fontSize"),10),d.css("fontSize",o+1+"px");b.size=1}this.size=b.size,f(d,k,i,!1)})}})(jQuery);